#!/bin/sh
export QT_QPA_PLATFORM=linuxfb:tty=/dev/fb0:rotation=270
export TZ='Asia/Shanghai'
export QT_QPA_FB_DRM=1
export QT_LINUXFB_DRM_LOGO=/oem/logo.bmp

SERVER_APP_NAME="X50Panguapp"
UI_APP_NAME="X50PanguQML"
DAEMON_APP_NAME="X50Daemon.sh"
BASE_PATH="/oem/marssenger"

start() {
    echo "Starting marssenger: "
    cd $(dirname $0)
    ./$SERVER_APP_NAME &
    ./$UI_APP_NAME &
    ./$DAEMON_APP_NAME &
    [ $? = 0 ] && echo "OK" || echo "FAIL"
}

stop() {
    echo "Stopping marssenger: "
    killall -9 $DAEMON_APP_NAME
    [ $? = 0 ] && echo "OK" || echo "FAIL"
    killall -9 $UI_APP_NAME
    [ $? = 0 ] && echo "OK" || echo "FAIL"
    killall -9 $SERVER_APP_NAME 
    [ $? = 0 ] && echo "OK" || echo "FAIL"
}

case "$1" in
    start)
        start
        ;;
    stop)
        stop
        ;;
    restart|reload)
        stop
        sleep 1
        start
        ;;
  *)
        echo "Usage: $0 {start|stop|restart}"
        exit 1
esac

exit $?
